## 타임리프 

### 특징
- [[서버 사이드 HTML 랜더링(SSR)]]
- [[네츄럴 템플릿]]
- 스프링 통합 지원 

### 타임리프 기본 문법
##### 타임리프 사용 선언
` <html xmlns:th="http://www.thymeleaf.org>`

#### 타임리프 기본 연산식
``` 
- 간단한 표현 : 
	- 변수 표현식 : ${...}
	- 선택 변수 표현식 : *{...}
	- 메시지 표현식 #{...}
	- 링크 URL 표현식 @{...}
	- 조각 표현식 ~{...}
- 리터널
	- 텍스트 : 'one text'
	- 숫자 : 0, 1, 3, 1.1
	- 불린 : true, false
	- 널 : null
	- 리터럴 토큰 : one, sometext, main
- 문자 연산 : 
	- 문자 합치기 : +
	- 리터럴 대체 : |Hello World ${name}|
- 산술 연산 :
	- Binary operators : +, -, *, /, %
	- Minus sign (unary operator) : -
- 불린 연산 : 
	- Binary operators : and, or
	- Boolean negation (unary operator) : !, not
	- 비교, 동등 :
			- 비교 : >, <, >=, <= (gt, lt, ge, le)
			- 동등 연산 : ==, != (eq, ne)
- 조건 연산 : 
	- If-then: (if) ? (then)
	- If-then-else:(if) ? (then) : else
	- Default: (value) ?: (defaultvalue)
- 특별한 토큰:
	- No-Operation: _
```

#### 텍스트 - text, utext
- 타임리프는 기본적으로 HTMl 태그의 속성에 기능을 정의해서 동작한다. HTML의 콘텐츠(content)에 데이터를 출력시 th:text를 사용한다.
	- `<span th:text="${data}">`
- HTML 태그의 속성 외에 HTMl 콘텐츠 안에 데이터를 직접 출력하고 싶으면 다음과 같이 `[[...]]`를 사용하면 된다.
	- `[[${data}]]`
#### Escape
- HTMl 문서는 `<`, `>`같은 특수 문자를 기반으로 정의된다. 따라서 뷰 템플릿으로 HTMl 화면을 생성할 때는 출력하는 데이터에 이러한 특수 문자가 있는것을 주의해서 사용해야 한다.
###### 예시
- `"hello <b>World<b>"`라는 문자열을 웹에서 출력하면`"hello <b>World<b>"` 소스보기에서 보면 `Hello &lt;b&gt;World!&lt;/b&gt;` 이런식으로 나오게 된다.
- 개발자가 의도한것은 `<b>`태그로 `World` 라는 문자열을 강조처리하고 싶었지만 실제로는 `<b>` 태그가 그대로 나오고 소스에서는 `<`부분이 `$lt;`로 변경되었다.

 ###### Html 엔티티
 웹 브라우저는 `<` 를 HTML 태그의 시작으로 인식한다. 따라서 `<`를 태그의 시작이 아니라 문자로 표현할 수 있는 방법이 필요한데, 이것을 HTMl 엔티티라고 한다. 그리고 이렇게 HTMl에서 사용하는 특수 문자를 HTML 엔티티로 변경하는 것을 이스케이프(escape)라고한다. 그리고 타임리프가 제공하는 `th:text`,`[[...]]`는 기본적으로 이스케이프(escape)를 제공한다.
  
#### Unescape
이스케이프 기능을 사용하지 않으려면 아래와 같이 사용하면 된다.

타임리프에서는 두가지 기능을 제공한다.
- `th:text` `th:utext` 
- `[[...]]` `[(...)]`

 TIP!
> 실제 서비스에서는 Escape를 사용하지 않아서 HTML이 정상 렌더링 되지 않는 많은 문제가 발생한다. 기본적으로 Escape를 기본적으로 사용하고, 꼭 필요할 때만 UnEscape를 사용하자.
#### 변수 - SpringEL
타임리프에서 변수 사용 법
- `${...}`

##### SpringEL 다양한 표현식 사용
**Object**  
- `user.username` : user의 username을 프로퍼티 접근 `user.getUsername()` 
- `user['username']` : 위와 같음 `user.getUsername()` 
- `user.getUsername()` : user의 `getUsername()` 을 직접 호출

**List**  
- `users[0].username` : List에서 첫 번째 회원을 찾고 username 프로퍼티 접근 `list.get(0).getUsername()`  
- `users[0]['username']` : 위와 같음  
- `users[0].getUsername()` : List에서 첫 번째 회원을 찾고 메서드 직접 호출

**Map**  
- `userMap['userA'].username` : Map에서 userA를 찾고, username 프로퍼티 접근 `map.get("userA").getUsername()`  
- `userMap['userA']['username']` : 위와 같음 
- `userMap['userA'].getUsername()` : Map에서 userA를 찾고 메서드 직접 호출

##### 지역 변수 선언
`th:with` 를 사용하면 지역 변수를 선언해서 사용할 수 있다. 지역 변수는 선언한 테그 안에서만 사용할 수 있다.





####  참조
- 공식 사이트: https://www.thymeleaf.org/  
- 공식 메뉴얼 - 기본 기능: https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html 
- 공식 메뉴얼 - 스프링 통합: https://www.thymeleaf.org/doc/tutorials/3.0/thymeleafspring.html 