카드 거래 내역에서 점포의 대표 이름 추출하기

카드 거래 내역에 있는 점포의 사업자번호와 점포 이름을 통해 사업자별 점포 이름 리스트를 추출하

려고 합니다.

카드 거래 내역에서 점포 이름은 제공기관의 상황에 따라 다양한 이름으로 저장됩니다. 뒷자리의 글 자들이 잘려서 저장되거나, 특수문자가 생략되기도 합니다.

예플 들어, '토스커피사일로&베이커리' 라는 카페의 점포 이름은 다음과 같이 다양한 형태로 저장될 수 있습니다.

토스커피사일로&베이커리 토스커피 사일로 베이커리 토스커피사일로 베이커 토스커피사일로 베이

토스커피사일

여기서 우리는 텍스트가 가장 긴 토스커피사일호S베이커리 가 점포 이름이라는 것을 알 수 있습니 다. 샘플링을 통해 여러 데이터를 확인해는 결과, 공백을 제외하고 가장 긴 텍스트인 경우, 그리고 특 수문자가 있다면 특수문자가 포함된 경우가 바로 점포 이름이라는 것이 확인되었습니다.

그런데 문제가 하나 더 있습니다. 이번에는 사업자 번호별 점포의 이름을 추출하려고 하는데, 하나의 사업자번호에 여러 점포가 매핑되는 경우, 즉 하나의 사업자 번호가 여러 점포 이름을 가지는 경우가 있었습니다.

테스트 케이스 추가하